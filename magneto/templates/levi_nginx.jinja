upstream {{ appname }}_backend {
    {% for host in hosts %}
    server {{ host.ip }}:16000;
    {% endfor %}
}

server {
    listen 80;
    server_name {{ appname }}.intra.hunantv.com;

    proxy_set_header X-SRI-APPNAME {{ appname }};
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $remote_addr;
    proxy_set_header Host $host;

    # error_page 400 402 403 404 /40x.html;
    # error_page 500 502 503 504 /50x.html;

    # rewrite ^/(.*)/favicon.ico$ /favicon.ico last;

    # access_log /data/log/nginx/{{ appname }}-access.log farm;
    # error_log /data/log/nginx/{{ appname }}-error.log error;

    # location ~* (favicon.ico) {
    #     log_not_found off;
    #     expires 30d;
    #     root /data/etc/nginx/html/;
    #     break;
    # }

    # location ~* (40x.html|50x.html)$ {
    #     internal;
    #     root /data/etc/nginx/html/;
    # }

    location ~ ^/ {
        proxy_pass http://{{ appname }}_backend;
    }
}
